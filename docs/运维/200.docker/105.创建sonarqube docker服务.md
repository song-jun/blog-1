---
title: 创建sonarqube docker服务
permalink: /install-sonarqube-docker.html
date: 2020-07-13 12:18:01
categories:
  - 运维
  - docker
tags:
  - 运维
  - docker
  - sonarqube
---

# 创建 sonarqube docker 服务

## 准备文件

/root/jdk-8u77-linux-x64.rpm  
/root/sonarqube-6.5.zip -d /root

## 创建构建脚本

vi /root/Dockerfile

```
FROM hub.c.163.com/library/centos:7.1.1503

EXPOSE 80
ADD ./sonarqube-6.5.zip /root/
ADD ./jdk-8u77-linux-x64.rpm /root/
RUN rpm -ivh /root/jdk-8u77-linux-x64.rpm
RUN yum install unzip -y
RUN unzip /root/sonarqube-6.5.zip -d /root
RUN sed -i "s/#sonar.web.port=9000/sonar.web.port=80/g" /root/sonarqube-6.5/conf/sonar.properties
RUN sed -i "s/#sonar.jdbc.url=jdbc:mysql:\/\/localhost/sonar.jdbc.url=jdbc:mysql:\/\/10.96.15.198/g" /root/sonarqube-6.5/conf/sonar.properties
RUN sed -i "s/#sonar.jdbc.username=/sonar.jdbc.username=root/g" /root/sonarqube-6.5/conf/sonar.properties
RUN sed -i "s/#sonar.jdbc.password=/sonar.jdbc.password=123456/g" /root/sonarqube-6.5/conf/sonar.properties
RUN sed -i "s/#sonar.jdbc.url=jdbc:mysql/sonar.jdbc.url=jdbc:mysql/g" /root/sonarqube-6.5/conf/sonar.properties

ENTRYPOINT /root/sonarqube-6.5/bin/linux-x86-64/sonar.sh start && /bin/bash
```

## 执行构建

- 创建镜像  
  docker build -t sonarqube:v1 /root
- 创建并运行容器  
  docker run -itd -p 80:80 --name sonarqube sonarqube:v1
- 访问容器服务  
  ![20200713121742.png](https://cdn.jsdelivr.net/gh/wangshibiaoFlytiger/blog_picBed1/images/20200713121742.png)
