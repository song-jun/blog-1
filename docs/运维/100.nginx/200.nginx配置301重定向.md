---
title: nginx配置301重定向
permalink: /nginx-redirect.html
date: 2020-06-13 13:28:49
categories:
  - 运维
  - nginx
  - https
tags:
  - 运维
  - https
  - nginx
  - 重定向
  - redirect
---

# nginx 配置 301 重定向

## http 重定向到 https

参考如下配置

```
# 将"http的www域名"重定向到"https的www域名"
server {
    #http端口
    listen       80;

    server_name  www.sofineday.com;

    access_log /var/log/nginx/www.sofineday.com.access_log;
    error_log /var/log/nginx/www.sofineday.com.error_log;

    return 301 https://www.sofineday.com$request_uri;
}

# 配置https的www域名
server {
    #https端口
    listen       443 ssl;

    server_name  www.sofineday.com;

    access_log /var/log/nginx/www.sofineday.com.access_log;
    error_log /var/log/nginx/www.sofineday.com.error_log;

    #https的证书配置
    ssl_certificate    /etc/nginx/cert/_.sofineday.com.full_chain.pem;
    ssl_certificate_key    /etc/nginx/cert/_.sofineday.com.private.key;


    root /static-file/blog;
}
```

## 主域名重定向到 www 域名

参考如下配置

```
# 将"http的主域名"重定向到"http的www域名"
server {
    #http端口
    listen       80;

    server_name  sofineday.com;

    access_log /var/log/nginx/sofineday.com.access_log;
    error_log /var/log/nginx/sofineday.com.error_log;

    return 301 http://www.sofineday.com$request_uri;
}

# 将"http的www域名"重定向到"https的www域名"
server {
    #http端口
    listen       80;

    server_name  www.sofineday.com;

    access_log /var/log/nginx/www.sofineday.com.access_log;
    error_log /var/log/nginx/www.sofineday.com.error_log;

    root /static-file/blog;
}
```

## 将"主域名或 http 域名"都重定向到 https 的 www 域名

::: tip
推荐该方案，终极方案，考虑得最完善！
做 seo 优化时，需要考虑该方案，详见[seo 重定向](/seo-redirect.html)
:::

参考如下配置

```
# 将"http或https的主域名"重定向到"https的www域名"
server {
    #http端口
    listen       80;
    #https端口
    listen       443 ssl;

    server_name  sofineday.com;

    access_log /var/log/nginx/sofineday.com.access_log;
    error_log /var/log/nginx/sofineday.com.error_log;

    #https的证书配置
    ssl_certificate    /etc/nginx/cert/_.sofineday.com.full_chain.pem;
    ssl_certificate_key    /etc/nginx/cert/_.sofineday.com.private.key;

    return 301 https://www.sofineday.com$request_uri;
}

# 将"http的www域名"重定向到"https的www域名"
server {
    #http端口
    listen       80;

    server_name  www.sofineday.com;

    access_log /var/log/nginx/www.sofineday.com.access_log;
    error_log /var/log/nginx/www.sofineday.com.error_log;

    return 301 https://www.sofineday.com$request_uri;
}

# 配置https的www域名
server {
    #https端口
    listen       443 ssl;

    server_name  www.sofineday.com;

    access_log /var/log/nginx/www.sofineday.com.access_log;
    error_log /var/log/nginx/www.sofineday.com.error_log;

    #https的证书配置
    ssl_certificate    /etc/nginx/cert/_.sofineday.com.full_chain.pem;
    ssl_certificate_key    /etc/nginx/cert/_.sofineday.com.private.key;


    root /static-file/blog;
}
```
