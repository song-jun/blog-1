(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{517:function(s,r,t){"use strict";t.r(r);var e=t(26),a=Object(e.a)({},(function(){var s=this,r=s.$createElement,t=s._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux-使用-supervisor-管理系统服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-使用-supervisor-管理系统服务"}},[s._v("#")]),s._v(" linux 使用 supervisor 管理系统服务")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("提供与"),t("RouterLink",{attrs:{to:"/linux-Systemd-service.html"}},[s._v("Systemd")]),s._v("类似的功能。")],1)]),s._v(" "),t("h2",{attrs:{id:"安装-supervisor-管理工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-supervisor-管理工具"}},[s._v("#")]),s._v(" 安装 supervisor 管理工具")]),s._v(" "),t("h3",{attrs:{id:"centos-安装-supervisor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos-安装-supervisor"}},[s._v("#")]),s._v(" centos 安装 supervisor")]),s._v(" "),t("p",[s._v("yum install python-setuptools -y"),t("br"),s._v("\neasy_install pip"),t("br"),s._v("\npip install supervisor")]),s._v(" "),t("h2",{attrs:{id:"基于模板生成-supervisor-的通用配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于模板生成-supervisor-的通用配置文件"}},[s._v("#")]),s._v(" 基于模板生成 supervisor 的通用配置文件")]),s._v(" "),t("p",[s._v("echo_supervisord_conf > /etc/supervisord.conf"),t("br"),s._v("\n补充如下配置")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[include]\nfiles = /etc/supervisord.d/*.conf\n")])])]),t("p",[s._v("为了方便管理，每个应用程序在/etc/supervisord.d 下创建一份单独的配置文件。")]),s._v(" "),t("h2",{attrs:{id:"启动-supervisor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动-supervisor"}},[s._v("#")]),s._v(" 启动 supervisor")]),s._v(" "),t("p",[s._v("supervisord -c /etc/supervisord.conf")]),s._v(" "),t("h2",{attrs:{id:"支持应用程序自动重启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#支持应用程序自动重启"}},[s._v("#")]),s._v(" 支持应用程序自动重启")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("此处以/root/redirect-api --profile back-pro 为例。")])]),s._v(" "),t("ol",[t("li",[s._v("创建配置文件/etc/supervisord.d/redirect.conf")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[program:redirect]\ncommand=/root/redirect-api --profile back-pro    ; 被监控的进程路径\npriority=1                    ;数字越高，优先级越高\nnumprocs=1                    ; 启动几个进程\nautostart=true                ; 随着supervisord的启动而启动\nautorestart=true              ; 自动重启。。当然要选上了\nstartretries=100               ; 启动失败时的最多重试次数\nexitcodes=0                   ; 正常退出代码（是说退出代码是这个时就不再重启了吗？待确定）\nstopsignal=KILL               ; 用来杀死进程的信号\nstopwaitsecs=10               ; 发送SIGKILL前的等待时间\nredirect_stderr=true          ; 重定向stderr到stdout\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("重新加载配置文件\nsupervisorctl reload")])]),s._v(" "),t("h2",{attrs:{id:"管理应用程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理应用程序"}},[s._v("#")]),s._v(" 管理应用程序")]),s._v(" "),t("h3",{attrs:{id:"通过命令行管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行管理"}},[s._v("#")]),s._v(" 通过命令行管理")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("此处以 redirect 应用程序为例。")])]),s._v(" "),t("p",[s._v("supervisorctl status "),t("strong",[s._v("redirect")]),t("br"),s._v("\nsupervisorctl stop "),t("strong",[s._v("redirect")]),t("br"),s._v("\nsupervisorctl start "),t("strong",[s._v("redirect")]),t("br"),s._v("\nsupervisorctl restart "),t("strong",[s._v("redirect")])]),s._v(" "),t("p",[s._v("把"),t("strong",[s._v("redirect")]),s._v("换成"),t("strong",[s._v("all")]),s._v("，即可管理所有应用程序。")]),s._v(" "),t("h3",{attrs:{id:"通过-web-界面管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过-web-界面管理"}},[s._v("#")]),s._v(" 通过 web 界面管理")]),s._v(" "),t("p",[s._v("这是 supervisor 的特色功能，Systemd 无此功能。"),t("br"),s._v("\n相关使用方法待日后完善。")]),s._v(" "),t("h2",{attrs:{id:"注意"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[s._v("#")]),s._v(" 注意")]),s._v(" "),t("h3",{attrs:{id:"supervisor-只能运行前台命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#supervisor-只能运行前台命令"}},[s._v("#")]),s._v(" supervisor 只能运行前台命令")]),s._v(" "),t("p",[s._v("无法运行 daemon 服务，如 "),t("strong",[s._v("service httpd start")]),s._v("。"),t("br"),s._v("\n若想运行 daemon 服务，也有解决方法，请自行查找教程。")])])}),[],!1,null,null,null);r.default=a.exports}}]);