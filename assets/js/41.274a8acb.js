(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{539:function(t,e,a){"use strict";a.r(e);var n=a(26),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vuepress-配置-cnzz-统计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-配置-cnzz-统计"}},[t._v("#")]),t._v(" vuepress 配置 cnzz 统计")]),t._v(" "),a("h2",{attrs:{id:"获取-cnzz-统计代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取-cnzz-统计代码"}},[t._v("#")]),t._v(" 获取 cnzz 统计代码")]),t._v(" "),a("ul",[a("li",[t._v("登录"),a("a",{attrs:{href:"https://www.umeng.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("友盟统计后台"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("创建站点")]),t._v(" "),a("li",[t._v("复制统计代码")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("https://v1.cnzz.com/z_stat.php?id=1278957718&web_id=1278957718\n")])])]),a("h2",{attrs:{id:"配置-cnzz-统计代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-cnzz-统计代码"}},[t._v("#")]),t._v(" 配置 cnzz 统计代码")]),t._v(" "),a("p",[t._v("vi ./config.js")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('head: [\n    // 添加cnzz统计\n    [\n      "script",\n      {\n        src: "https://v1.cnzz.com/z_stat.php?id=1278957718&web_id=1278957718"\n      }\n    ]\n  ]\n')])])]),a("h2",{attrs:{id:"切换页面时手工上报-pv-统计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#切换页面时手工上报-pv-统计"}},[t._v("#")]),t._v(" 切换页面时手工上报 pv 统计")]),t._v(" "),a("p",[t._v("目前存在一个问题，仅在访问首页或者刷新页面时，才会触发 cnzz 统计。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("因为 vuepress 是基于 vue 的单页面应用，所以页面切换过程中，不会重新加载页面，故而不会触发 cnzz 统计。")])]),t._v(" "),a("p",[t._v("解决方法: 监听路由切换事件，当切换页面时, 手动上报 cnzz 统计, 具体实现如下:"),a("br"),t._v("\nvi .vuepress/enhanceApp.js")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('export default ({ router }) => {\n  /**\n   * 路由切换事件处理\n   */\n  router.beforeEach((to, from, next) => {\n    console.log("切换路由", to.fullPath, from.fullPath);\n\n    //发送cnzz的pv统计\n    if (typeof _czc != "undefined") {\n      if (to.path) {\n        _czc.push(["_trackPageview", to.fullPath, from.fullPath]);\n        console.log("上报cnzz统计", to.fullPath);\n      }\n    }\n\n    // continue\n    next();\n  });\n};\n')])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("每当切换路由就会触发统计上报。所以发生如下行为时会上报统计:")]),t._v(" "),a("ul",[a("li",[t._v("首次访问")]),t._v(" "),a("li",[t._v("刷新页面")]),t._v(" "),a("li",[t._v("切换到当前文章的其它章节"),a("br"),t._v("\n切换锚点，URL 会变化，所以会触发路由变化事件。"),a("br"),t._v("\n所以，当用户完整得浏览完一篇博客时，可能会触发多次上报。")])])]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://open.cnzz.com/a/api/trackpageview/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cnzz 统计官方 js-api 文档"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=s.exports}}]);