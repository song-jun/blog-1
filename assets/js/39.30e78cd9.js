(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{537:function(t,a,s){"use strict";s.r(a);var e=s(26),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vuepress-配置谷歌统计"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-配置谷歌统计"}},[t._v("#")]),t._v(" vuepress 配置谷歌统计")]),t._v(" "),s("h2",{attrs:{id:"获取-谷歌-统计代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取-谷歌-统计代码"}},[t._v("#")]),t._v(" 获取 谷歌 统计代码")]),t._v(" "),s("ul",[s("li",[t._v("登录"),s("a",{attrs:{href:"https://analytics.google.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("谷歌统计后台"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("创建站点")]),t._v(" "),s("li",[t._v("复制统计代码")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wangshibiaoFlytiger/blog_picBed1/images/20200603112847.png",alt:"20200603112847.png"}})]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\x3c!-- Global site tag (gtag.js) - Google Analytics --\x3e\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=UA-168383599-1\"><\/script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'UA-168383599-1');\n<\/script>\n")])])]),s("h2",{attrs:{id:"配置-谷歌-统计代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-谷歌-统计代码"}},[t._v("#")]),t._v(" 配置 谷歌 统计代码")]),t._v(" "),s("h3",{attrs:{id:"终极方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#终极方案"}},[t._v("#")]),t._v(" 终极方案")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("该方案考虑到了路由切换的场景，完美，推荐采用。"),s("br"),t._v("\n每当切换路由就会触发统计上报。所以发生如下行为时会上报统计:")]),t._v(" "),s("ul",[s("li",[t._v("首次访问")]),t._v(" "),s("li",[t._v("刷新页面")]),t._v(" "),s("li",[t._v("切换到当前文章的其它章节"),s("br"),t._v("\n切换锚点，URL 会变化，所以会触发路由变化事件。"),s("br"),t._v("\n所以，当用户完整得浏览完一篇博客时，可能会触发多次上报。")])])]),t._v(" "),s("ul",[s("li",[t._v("安装依赖"),s("br"),t._v("\nyarn add -D @vuepress/plugin-google-analytics")]),t._v(" "),s("li",[t._v("修改配置 config.js")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("module.exports = {\n  plugins: [\n    [\n      '@vuepress/google-analytics',\n      {\n        'ga': 'UA-00000000-0' //替换成自己实际申请的ID\n      }\n    ]\n  ]\n}\n")])])]),s("blockquote",[s("p",[t._v("参考"),s("a",{attrs:{href:"https://vuepress.vuejs.org/plugin/official/plugin-google-analytics.html#install",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"不完美方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不完美方案"}},[t._v("#")]),t._v(" 不完美方案")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("不建议采用该方案，网络上可以看到很多教程讲授的就是该方案，本文专门列举出，就是为了让博友引起注意，并给出不推荐使用的理由。")])]),t._v(" "),s("p",[t._v("起初采用的该方案，但是有漏洞: 仅首次访问或有页面刷新行为时，才会触发谷歌统计。"),s("br"),t._v("\n因为 vuepress 是单页面架构, 所以切换路由(即切换页面)的时候，并不会有页面刷新动作，导致谷歌统计代码不会执行，进而会漏掉上报行为。"),s("br"),t._v("\nvi ./config.js")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("head: [\n    /*************** start 添加谷歌统计 ***********/\n    [\n      \"script\",\n      {\n        src: \"https://www.googletagmanager.com/gtag/js?id=UA-168383599-1\",\n        async: true\n      }\n    ],\n    [\n      \"script\",\n      {},\n      `\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag('js', new Date());\n        gtag('config', 'UA-168383599-1');\n      `\n    ],\n    /*************** end 添加谷歌统计 ***********/\n  ]\n")])])]),s("h2",{attrs:{id:"验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[t._v("#")]),t._v(" 验证")]),t._v(" "),s("h3",{attrs:{id:"通过-chrome-开发者工具过滤请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过-chrome-开发者工具过滤请求"}},[t._v("#")]),t._v(" 通过 Chrome 开发者工具过滤请求")]),t._v(" "),s("p",[t._v("查看是否有谷歌统计的请求, 会发车 2 个请求(analytics.js 和 collect)"),s("br"),t._v(" "),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wangshibiaoFlytiger/blog_picBed1/images/20200615104149.png",alt:"20200615104149.png"}})]),t._v(" "),s("h3",{attrs:{id:"通过-chrome-插件-tag-assistant"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过-chrome-插件-tag-assistant"}},[t._v("#")]),t._v(" 通过 chrome 插件 Tag Assistant")]),t._v(" "),s("p",[t._v("该插件提供如下功能")]),t._v(" "),s("ul",[s("li",[t._v("检查 GA 代码（包括 Classic Google Analytics 和 Universal Analytics）")]),t._v(" "),s("li",[t._v("检查 GTM 代码")]),t._v(" "),s("li",[t._v("检查其他 Google 营销相关代码")])])])}),[],!1,null,null,null);a.default=n.exports}}]);